<% layout('layout/boilerplate') %>

  <div class="container mt-5">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h2 class="card-title">Add New Product</h2>
            <form action="/product/<%=product.product_id%>?_method=PUT" method="post" enctype="multipart/form-data">
              <div class="form-group">
                <label for="productName">Product Name:</label>
                <input type="text" class="form-control" id="productName" name="productName"
                  value="<%=product.product_name%>">
                <div class="invalid-feedback">Please provide a valid name.</div>
                <div class="valid-feedback">
                  Looks good!
                </div>
              </div>
              <div class="form-group">
                <label for="image">Image</label>
                <input type="file" class="form-control" id="image" name="image">
                <div class="invalid-feedback">Please choose an image.</div>
                <div class="valid-feedback">
                  Looks good!
                </div>
                <div class="form-group">
                  <label for="description">Description:</label>
                  <textarea class="form-control" id="description" name="description" rows="3"
                    value="<%=product.description%>" required></textarea>
                  <div class="invalid-feedback">Please provide a valid description.</div>
                  <div class="valid-feedback">
                    Looks good!
                  </div>
                </div>
                <div class="form-group">
                  <label for="quantity">Quantity:</label>
                  <input type="number" class="form-control" id="quantity" value="<%=product.quantity%>" name="quantity"
                    required>
                  <div class="invalid-feedback">Please provide a valid quantity.</div>
                  <div class="valid-feedback">
                    Looks good!
                  </div>
                </div>
                <div class="form-group">
                  <label for="quality">Quality:</label>
                  <select class="form-control" id="quality" name="quality" value="<%=product.quality%>" required>
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="high">High</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="startingPrice">Starting Price:</label>
                  <input type="number" class="form-control" id="startingPrice" name="startingPrice" step="0.01"
                    value="<%=product.starting_price%>" required>
                </div>
                <div class="form-group">
                  <label for="reserve_price">MSP Reserve Price:</label>
                  <select class="form-control" id="reserve_price" name="reserve_price"
                    value="<%=product.reserve_price%>" required>
                    <% mspset.forEach(function(crop){ %>
                      <option value="<%=crop.price%>">
                        <%=crop.crop_name%>(<%=crop.price%>)
                      </option>
                      <%})%>
                  </select>
                </div>
                <button type="submit" class="btn btn-primary btn-block">EDIT</button>
            </form>
            <a href="/product" class="btn btn-primary btn-block">BACK</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (() => {
      'use strict'

      const forms = document.querySelectorAll('.validated-form')

      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }

          form.classList.add('was-validated')
        }, false)
      })
    })()
  </script>